<!--
  ~ Copyright (c) 2014 Hewlett-Packard Development Company, L.P.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License"); you may
  ~ not use this file except in compliance with the License. You may obtain
  ~ a copy of the License at
  ~
  ~         http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  ~ WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing permissions and limitations
  ~ under the License.
  -->

<div class="row">
    <div class="col-sm-9 col-xs-11">
        <p ng-show="story.description">
            {{story.description}}
        </p>
        <em ng-hide="story.description"
            class="text-muted">
            No description available
        </em>
    </div>
    <div class="col-sm-3 col-xs-1">
        <a href=""
           ng-click="showAddTaskForm = !showAddTaskForm"
           ng-show="isLoggedIn"
           class="pull-right btn btn-default btn-sm">
            <span ng-hide="showAddTaskForm">
                <i class="fa fa-plus"></i>&nbsp;
                <span class="hidden-xs">Add Task</span>
            </span>
            <span ng-show="showAddTaskForm">
                <i class="fa fa-minus"></i>&nbsp;
                <span class="hidden-xs">Add Task</span>
            </span>
        </a>
    </div>
</div>
<div class="row" ng-show="showAddTaskForm">
    <br/>

    <div class="col-sm-12">
        <div class="well">
            <form role="form" name="taskForm">
                <div class="form-group row">
                    <label for="title" class="col-sm-2 control-label">
                        Task Title:
                    </label>

                    <div class="col-sm-10">
                        <input id="title"
                               type="text"
                               class="form-control"
                               ng-model="newTask.title"
                               required
                               placeholder="Task Title">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="project" class="col-sm-2 control-label">
                        Task Project:
                    </label>

                    <div class="col-sm-10">
                        <select ng-model="newTask.project_id"
                                id="project"
                                name="project"
                                class="form-control"
                                required
                                ng-options="p.id as p.name for p in projects"/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-offset-2 col-sm-10">
                        <button type="submit" class="btn btn-default"
                                ng-click="addTask()"
                                ng-disabled="!taskForm.$valid">
                            Add task
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-sm-12">
        <table class="table table-striped">
            <thead>
            <tr>
                <th class="col-sm-1">
                    <small>ID</small>
                </th>
                <th class="col-sm-6">
                    <small>Title</small>
                </th>
                <th class="col-sm-3">
                    <small>Project</small>
                </th>
                <th class="col-sm-2">
                    <small>Status</small>
                </th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="task in tasks"
                ng-controller="StoryTaskListItemController">
                <td>
                    <p><strong>
                        <a href="">{{task.id}}</a>
                    </strong></p>
                </td>
                <td>
                    <p><strong>
                        <a href="">{{task.title}}</a>
                    </strong></p>
                    <small class="text-muted">{{task.description}}</small>
                </td>
                <td>
                    <p>
                        <a href="#!/project/{{project.id}}/overview"
                           ng-show="project">
                            {{project.name}}
                        </a>

                        <span class="text-danger" ng-hide="project">
                            Project not found
                        </span>
                    </p>
                </td>
                <td>
                    <p class="text-success">{{task.status}}</p>
                </td>
            </tr>
            </tbody>
        </table>

    </div>

</div>