<!--
  ~ Copyright (c) 2014 Hewlett-Packard Development Company, L.P.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License"); you may
  ~ not use this file except in compliance with the License. You may obtain
  ~ a copy of the License at
  ~
  ~ 	http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  ~ WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing permissions and limitations
  ~ under the License.
  -->
<div class="container">
    <div class="row">
        <div class="col-xs-12">
            <a href="#!/project/new"
               permission="is_superuser"
               class="pull-right btn btn-default btn-sm line-height"
               ng-show="isLoggedIn">
                <i class="fa fa-plus"></i>
                <span class="hidden-xs">New Project</span>
            </a>

            <h1>{{projectCount}} Projects</h1>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-3 col-xs-7">
            <div class="btn-group btn-group-justified">
                <div class="form-group has-feedback has-feedback-no-label">
                    <input type="text"
                           class="form-control input-sm"
                           placeholder="Search Projects"
                           ng-disabled="isSearching"
                           ng-enter="search()"
                           ng-model="searchQuery"/>
                    <span class="fa fa-search form-control-feedback"
                          ng-hide="isSearching"></span>
                    <span class="fa fa-refresh fa-spin form-control-feedback"
                          ng-show="isSearching"></span>
                </div>
            </div>
        </div>
        <div class="col-sm-9 col-xs-5">
            <pagination total-items="total"
                        class="pagination-sm pull-right hidden-xs"
                        page="page"
                        items-per-page="pageSize"
                        max-size="5"
                        class="pagination-sm"
                        boundary-links="true"
                        on-select-page="search(page)"
                        first-text="&laquo;"
                        previous-text="&lsaquo;"
                        next-text="&rsaquo;"
                        last-text="&raquo;"/>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <div ng-show="isSearching">
                <hr/>
                <p class="text-center">
                    <i class="fa fa-refresh fa-spin fa-lg"></i>
                </p>
            </div>

            <p ng-show="!isSearching && projects.length == 0"
               class="text-center text-warning">
                <em> We were unable to find any projects.</em>
            </p>

            <table class="table table-striped"
                   ng-hide="isSearching || projects.length == 0">
                <thead>
                <tr>
                    <th class="col-sm-10">
                        <small>Project Name</small>
                    </th>
                    <th class="col-sm-2 text-right">
                        <small>
                            <strong>Stories</strong><br/>
                            Opened / Total
                        </small>
                    </th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="project in projects">
                    <td>
                        <p><strong>
                            <a href="#!/project/{{project.id}}">
                                {{project.name}}
                            </a>
                        </strong></p>
                        <small class="text-muted">
                            {{project.description}}
                        </small>
                    </td>
                    <td class="text-right">
                        <p class="text-muted">
                            {{project.openStories}} / {{project.totalStories}}
                        </p>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<paging-footer
        class="visible-xs"
        on-change="search(selectedPage)"
        page="{{page}}"
        page-total="{{pageTotal}}"
        />